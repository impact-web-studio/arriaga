---
import { Icon } from 'astro-icon/components';
import { getImage } from 'astro:assets';
import heroBackgroundImage from '~/assets/premier-hero-bg.jpeg';

const optimizedImage = await getImage({ src: heroBackgroundImage });
const backgroundURL = `url(${optimizedImage.src})`;

const {
	title = await Astro.slots.render('title'),
	subtitle = await Astro.slots.render('subtitle'),
	tagline,

	actions = await Astro.slots.render('actions'),
	badges = await Astro.slots.render('badges'),
	bottomFeatures = await Astro.slots.render('bottomFeatures'),

	id,
	bg = await Astro.slots.render('bg'),
	backgroundImage,
	// Phone number prop
	phoneNumber = '+13163304092',
	phoneDisplay = '(316) 330-4092',
} = Astro.props;
---

<section
	class:list={['hero-bg min-h-screen flex items-center relative not-prose']}
	{...id ? { id } : {}}
>
	<div
		class="absolute inset-0 pointer-events-none"
		aria-hidden="true"
	>
		<!-- <slot name="image">
			{image ? <Fragment set:html={bg} /> : null}
		</slot> -->
	</div>

	<div class="container mx-auto px-4 py-20 relative">
		<div class="max-w-4xl mx-auto text-center text-white">
			<!-- Top badges section -->
			<div
				class="flex items-center justify-center space-x-4 mb-6 intersect-once intersect-half motion-safe:md:opacity-0 motion-safe:md:intersect:animate-(--animation-fade)"
			>
				<slot name="badges">
					{
						badges ? (
							<Fragment set:html={badges} />
						) : (
							<>
								<div class="flex items-center space-x-1">
									{Array.from({ length: 5 }).map((_, i) => (
										<Icon
											name="lucide:star"
											class="h-5 w-5 fill-accent-400 text-accent-400"
										/>
									))}
									<span class="ml-2 text-accent-100 font-medium">
										5.0 Rating
									</span>
								</div>
								<div class="hidden sm:block w-px h-6 bg-white/30" />
								<div class="flex items-center space-x-2">
									<Icon
										name="lucide:shield"
										class="h-5 w-5 text-accent-400"
									/>
									<span class="text-accent-100 font-medium">
										Licensed & Insured
									</span>
								</div>
							</>
						)
					}
				</slot>
			</div>

			<!-- Tagline -->
			{
				tagline && (
					<p
						class="text-base text-accent-100 font-bold tracking-wide uppercase mb-4 intersect-once intersect-half motion-safe:md:opacity-0 motion-safe:md:intersect:animate-(--animation-fade)"
						set:html={tagline}
					/>
				)
			}

			<!-- Main title -->
			{
				title && (
					<h1
						class="font-heading text-5xl md:text-6xl lg:text-7xl font-bold mb-6 leading-tight intersect-once intersect-half motion-safe:md:opacity-0 motion-safe:md:intersect:animate-(--animation-fade)"
						set:html={title}
					/>
				)
			}

			<!-- Default title if no title prop/slot -->
			{
				!title && (
					<slot name="title">
						<h1 class="font-heading text-5xl md:text-6xl lg:text-7xl font-bold mb-6 leading-tight intersect-once intersect-half motion-safe:md:opacity-0 motion-safe:md:intersect:animate-(--animation-fade)">
							Bring Your Dream Home to <span class="text-accent-400">Life</span>
						</h1>
					</slot>
				)
			}

			<!-- Subtitle -->
			{
				subtitle && (
					<p
						class="text-xl md:text-2xl mb-8 text-blue-100 max-w-3xl mx-auto leading-relaxed intersect-once intersect-half motion-safe:md:opacity-0 motion-safe:md:intersect:animate-(--animation-fade)"
						set:html={subtitle}
					/>
				)
			}

			<!-- Default subtitle if no subtitle prop/slot -->
			{
				!subtitle && (
					<slot name="subtitle">
						<p class="text-xl md:text-2xl mb-8 text-blue-100 max-w-3xl mx-auto leading-relaxed intersect-once intersect-half motion-safe:md:opacity-0 motion-safe:md:intersect:animate-(--animation-fade)">
							Trusted renovations with craftsmanship you can count on.
							<span class="block mt-2">
								Transform your space with our expert team.
							</span>
						</p>
					</slot>
				)
			}

			<!-- Actions/CTA buttons -->
			<div
				class="flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-6 mb-12 intersect-once intersect-half motion-safe:md:opacity-0 motion-safe:md:intersect:animate-(--animation-fade)"
			>
				<slot name="actions">
					{
						actions ? (
							<Fragment set:html={actions} />
						) : (
							<>
								<button
									id="get-estimate-btn"
									class="bg-accent-500 text-accent-900 px-8 py-4 rounded-lg font-semibold text-lg hover:bg-accent-400 transition-all duration-300 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:-translate-y-1"
								>
									<span>Get a Free Estimate</span>
									<Icon
										name="lucide:arrow-right"
										class="h-5 w-5"
									/>
								</button>

								<a
									href={`tel:${phoneNumber}`}
									class="border-2 border-white text-white px-8 py-4 rounded-lg font-semibold text-lg hover:bg-white hover:text-primary-900 transition-all duration-300"
								>
									Call Now: {phoneDisplay}
								</a>
							</>
						)
					}
				</slot>
			</div>

			<!-- Bottom features -->
			<div
				class="flex flex-wrap items-center justify-center gap-8 text-sm text-blue-200 intersect-once intersect-half motion-safe:md:opacity-0 motion-safe:md:intersect:animate-(--animation-fade)"
			>
				<slot name="bottomFeatures">
					{
						bottomFeatures ? (
							<Fragment set:html={bottomFeatures} />
						) : (
							<>
								<div class="flex items-center space-x-2">
									<Icon
										name="lucide:award"
										class="h-5 w-5 text-accent-400"
									/>
									<span>25+ Years Experience</span>
								</div>
								<div class="flex items-center space-x-2">
									<Icon
										name="lucide:shield"
										class="h-5 w-5 text-accent-400"
									/>
									<span>Fully Licensed & Bonded</span>
								</div>
								<div class="flex items-center space-x-2">
									<Icon
										name="lucide:star"
										class="h-5 w-5 text-accent-400"
									/>
									<span>500+ Happy Customers</span>
								</div>
							</>
						)
					}
				</slot>
			</div>
		</div>
	</div>

	<!-- Scroll indicator -->
	<div
		class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce"
	>
		<div
			class="w-6 h-10 border-2 border-white/50 rounded-full flex justify-center"
		>
			<div class="w-1 h-3 bg-white/70 rounded-full mt-2 animate-pulse"></div>
		</div>
	</div>
</section>

<script>
	function scrollToContact() {
		const element = document.getElementById('contact');
		if (element) {
			element.scrollIntoView({ behavior: 'smooth' });
		}
	}

	// Add event listener to the button
	document.addEventListener('DOMContentLoaded', () => {
		const button = document.getElementById('get-estimate-btn');
		if (button) {
			button.addEventListener('click', scrollToContact);
		}
	});
</script>

<style define:vars={{ backgroundURL }}>
	.hero-bg {
		background-image: linear-gradient(
				135deg,
				rgba(30, 58, 138, 0.9) 0%,
				rgba(30, 58, 138, 0.7) 100%
			),
			var(--backgroundURL);
		background-size: cover;
		background-position: center;
		background-attachment: fixed;
	}
</style>
