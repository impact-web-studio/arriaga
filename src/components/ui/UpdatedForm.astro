---
import client from '~/data/client/client.json';

declare global {
	interface Window {
		LC?: {
			init?: () => void;
			[key: string]: any;
		};
	}
}

// TODO: Update Form URL
const src =
	'https://api.leadconnectorhq.com/widget/service-menu/68e76431a172e2af21b8c672';
const id = '68e76431a172e2af21b8c672_1759994947530';
---

<div
	id="form-wrapper"
	class="w-full h-fit relative form-container shadow-2xl rounded-2xl"
>
	<iframe
		src={src}
		style="width: 100%; height:100%; border: none; overflow: hidden;"
		id={id}
		loading="eager"
		data-form-name=`${client.companyName} - Request Your Free Consultation`
		title=`${client.companyName} - Request Your Free Consultation`
	></iframe>
</div>

<style>
	.form-container {
		opacity: 0;
		animation: fadeIn 0.5s ease forwards;
		animation-delay: 250ms; /* Delay to ensure iframe content is fully loaded */
	}
	.form-container iframe {
		padding: 0 !important; /* Remove GHL iframe padding */
	}
	@keyframes fadeIn {
		to {
			opacity: 1;
		}
	}
</style>

<script>
	function initializeGHLForm() {
		const formContainer = document.querySelector('#form-wrapper');
		if (!formContainer) return;

		const iframe = formContainer.querySelector('iframe');
		if (!iframe) return;

		if (window.LC && window.LC.init) {
			try {
				window.LC.init();
			} catch (error) {
				// Silent catch to ensure form loads
			}
		}
	}

	document.addEventListener('DOMContentLoaded', initializeGHLForm);
	document.addEventListener('astro:page-load', initializeGHLForm);
</script>

<script
	src="https://link.msgsndr.com/js/form_embed.js"
	type="text/javascript"
></script>
