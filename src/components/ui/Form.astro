---
declare global {
	interface Window {
		LC?: {
			init?: () => void;
			[key: string]: any;
		};
	}
}

const src = 'https://api.leadconnectorhq.com/widget/form/flYePdz4vua45Q6gslVN';
---

<div
	id="form-wrapper"
	class="w-full h-fit relative form-container shadow-2xl rounded-2xl"
>
	<iframe
		src={src}
		style="width: 100%; height:100%; border: none; overflow: hidden; border-radius:16px"
		id="inline-flYePdz4vua45Q6gslVN"
		loading="eager"
		data-form-name="Premier Renovations - Request Your Free Consultation"
		data-form-id="flYePdz4vua45Q6gslVN"
		title="Premier Renovations - Request Your Free Consultation"
	></iframe>
</div>

<style>
	.form-container {
		opacity: 0;
		animation: fadeIn 0.5s ease forwards;
		animation-delay: 250ms; /* Delay to ensure iframe content is fully loaded */
	}
	.form-container iframe {
		padding: 0 !important; /* Remove GHL iframe padding */
	}
	@keyframes fadeIn {
		to {
			opacity: 1;
		}
	}
</style>

<script>
	function initializeGHLForm() {
		const formContainer = document.querySelector('#form-wrapper');
		if (!formContainer) return;

		const iframe = formContainer.querySelector('iframe');
		if (!iframe) return;

		if (window.LC && window.LC.init) {
			try {
				window.LC.init();
			} catch (error) {
				// Silent catch to ensure form loads
			}
		}
	}

	document.addEventListener('DOMContentLoaded', initializeGHLForm);
	document.addEventListener('astro:page-load', initializeGHLForm);
</script>

<script
	src="https://link.msgsndr.com/js/form_embed.js"
	type="text/javascript"
></script>
